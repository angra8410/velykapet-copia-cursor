# ğŸ“Š Diagrama de Flujo - Script PowerShell Importador Masivo

## ğŸ”„ Flujo Principal del Script

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        INICIO DEL SCRIPT                         â”‚
â”‚                     importar-masivo.ps1                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MENSAJE DE BIENVENIDA                       â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—     â”‚
â”‚  â•‘  IMPORTADOR MASIVO DE PRODUCTOS - VelyKapet           â•‘     â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 AYUDA SOBRE FORMATO CSV                          â”‚
â”‚  ğŸ“‹ Muestra:                                                     â”‚
â”‚    â€¢ Campos obligatorios (CATEGORIA, NAME, PRICE)               â”‚
â”‚    â€¢ Campos opcionales (description, stock, etc.)               â”‚
â”‚    â€¢ Ejemplo de CSV                                              â”‚
â”‚    â€¢ Links a documentaciÃ³n completa                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   SOLICITAR ARCHIVO CSV                          â”‚
â”‚  Pedir ruta del archivo                                          â”‚
â”‚  Sugerencia: sample-products.csv (default)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Â¿Archivo      â”‚
                    â”‚  existe?       â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                         â”‚     â”‚
                    NO   â”‚     â”‚   SÃ
                         â”‚     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                     â”‚
        â–¼                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MOSTRAR ERROR     â”‚              â”‚ VALIDAR EXTENSIÃ“N    â”‚
â”‚ - Archivo no      â”‚              â”‚ Â¿Es .csv?            â”‚
â”‚   encontrado      â”‚              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ - Sugerencias     â”‚                     â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 NO  â”‚       â”‚  SÃ
         â”‚                                 â”‚       â”‚
         â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
         â”‚                    â”‚                    â”‚
         â”‚                    â–¼                    â–¼
         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚         â”‚ ADVERTENCIA         â”‚  â”‚ MOSTRAR INFO     â”‚
         â”‚         â”‚ Â¿Continuar?         â”‚  â”‚ - Nombre archivo â”‚
         â”‚         â”‚ (S/N)               â”‚  â”‚ - TamaÃ±o         â”‚
         â”‚         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ - Fecha mod.     â”‚
         â”‚                â”‚      â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚            NO  â”‚      â”‚  SÃ               â”‚
         â”‚                â”‚      â”‚                   â”‚
         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
         â”‚    â”‚                              â”‚       â”‚
         â”‚    â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚    â”‚
         â–¼    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Â¿REINTENTAR?        â”‚
â”‚ (S/N)               â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚      â”‚
   NO  â”‚      â”‚  SÃ
       â”‚      â”‚
       â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                     â”‚
       â–¼                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ SALIR        â”‚             â”‚
â”‚ (exit 0)     â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                             â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONFIRMACIÃ“N FINAL                            â”‚
â”‚  Â¿Desea proceder con la importaciÃ³n? (S/N)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                        NO   â”‚   SÃ
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                           â”‚
                â–¼                           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ CANCELAR      â”‚      â”‚ ENVIAR SOLICITUD HTTP          â”‚
        â”‚ ImportaciÃ³n   â”‚      â”‚ POST multipart/form-data       â”‚
        â”‚ cancelada     â”‚      â”‚ a /api/Productos/ImportarCsv   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Â¿Respuesta exitosa?     â”‚
                            â”‚  (HTTP 200 OK)           â”‚
                            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚              â”‚
                            SÃ   â”‚              â”‚   NO
                                 â”‚              â”‚
                                 â”‚              â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                                               â”‚
                â–¼                                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MOSTRAR RESULTADO EXITOSO           â”‚      â”‚ MOSTRAR ERROR                â”‚
â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚      â”‚ âŒ ERROR HTTP {code}         â”‚
â”‚ âœ… RESPUESTA DEL SERVIDOR           â”‚      â”‚ Contenido del error          â”‚
â”‚                                     â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ ğŸ“Š RESUMEN:                         â”‚                 â”‚
â”‚   â€¢ Total procesados: X             â”‚                 â–¼
â”‚   â€¢ Exitosos: X                     â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â€¢ Fallidos: X                     â”‚      â”‚ SUGERENCIAS SEGÃšN HTTP CODE: â”‚
â”‚                                     â”‚      â”‚ â€¢ 0   â†’ Verificar backend    â”‚
â”‚ âš ï¸ ERRORES (si hay):                â”‚      â”‚ â€¢ 400 â†’ Revisar formato CSV  â”‚
â”‚   â€¢ LÃ­nea X: descripciÃ³n error      â”‚      â”‚ â€¢ 404 â†’ Verificar URL API    â”‚
â”‚                                     â”‚      â”‚ â€¢ 500 â†’ Error interno        â”‚
â”‚ ğŸ’¬ MENSAJE:                         â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   DescripciÃ³n del resultado         â”‚                 â”‚
â”‚                                     â”‚                 â–¼
â”‚ âœ¨ PRODUCTOS CREADOS:               â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   1. [ID] Nombre producto           â”‚      â”‚ Â¿Cambiar archivo? (S/N)      â”‚
â”‚   2. [ID] Nombre producto           â”‚      â””â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   ...                               â”‚        â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    SÃ  â”‚            â”‚  NO
                 â”‚                             â”‚            â”‚
                 â–¼                             â”‚            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Â¿Importar otro archivo? (S/N)       â”‚        â”‚  â”‚ Â¿Reintentar? (S/N)      â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â””â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                â”‚                       â”‚    â”‚               â”‚
  SÃ  â”‚                â”‚  NO               SÃ  â”‚    â”‚  NO
      â”‚                â”‚                       â”‚    â”‚               â”‚
      â”‚                â””â”€â”€â”€â”€â”€â”€â”                â”‚    â”‚               â”‚
      â”‚                       â”‚                â”‚    â”‚               â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚               â”‚
                              â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚                              â”‚
                              â–¼                              â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
                   â”‚ VOLVER AL INICIO   â”‚                    â”‚
                   â”‚ (bucle while)      â”‚                    â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                                                            â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MENSAJE DE DESPEDIDA                        â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—     â”‚
â”‚  â•‘    Gracias por usar el Importador de VelyKapet        â•‘     â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   FIN   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ Funciones Principales

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FUNCIONES DEL SCRIPT                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚ ğŸ“¢ Show-Welcome()                                                â”‚
â”‚    â””â”€ Muestra mensaje de bienvenida con bordes                  â”‚
â”‚                                                                  â”‚
â”‚ ğŸ“‹ Show-CsvFormatHelp()                                          â”‚
â”‚    â””â”€ Explica formato CSV esperado                              â”‚
â”‚    â””â”€ Muestra campos obligatorios y opcionales                  â”‚
â”‚    â””â”€ Referencias a documentaciÃ³n                               â”‚
â”‚                                                                  â”‚
â”‚ ğŸ“‚ Get-CsvFilePath($DefaultFile)                                â”‚
â”‚    â””â”€ Solicita ruta del archivo                                 â”‚
â”‚    â””â”€ Retorna ruta (default si ENTER)                           â”‚
â”‚                                                                  â”‚
â”‚ ğŸ” Test-CsvFile($FilePath)                                       â”‚
â”‚    â””â”€ Verifica existencia del archivo                           â”‚
â”‚    â””â”€ Valida extensiÃ³n .csv                                     â”‚
â”‚    â””â”€ Muestra informaciÃ³n (tamaÃ±o, fecha)                       â”‚
â”‚    â””â”€ Retorna $true/$false                                      â”‚
â”‚                                                                  â”‚
â”‚ ğŸ“¤ Invoke-CsvImport($FilePath, $ApiUrl)                         â”‚
â”‚    â””â”€ Construye request multipart/form-data                     â”‚
â”‚    â””â”€ EnvÃ­a archivo al servidor                                 â”‚
â”‚    â””â”€ Maneja errores de conexiÃ³n                                â”‚
â”‚    â””â”€ Retorna hashtable con resultado                           â”‚
â”‚                                                                  â”‚
â”‚ ğŸ¨ Format-JsonResponse($JsonString)                              â”‚
â”‚    â””â”€ Parsea JSON string                                        â”‚
â”‚    â””â”€ Formatea con indentaciÃ³n                                  â”‚
â”‚    â””â”€ Retorna JSON formateado                                   â”‚
â”‚                                                                  â”‚
â”‚ ğŸ“Š Show-ImportResult($Response)                                  â”‚
â”‚    â””â”€ Muestra resultado formateado                              â”‚
â”‚    â””â”€ Resumen visual (procesados/exitosos/fallidos)             â”‚
â”‚    â””â”€ Lista de errores si existen                               â”‚
â”‚    â””â”€ Productos creados (primeros 5)                            â”‚
â”‚                                                                  â”‚
â”‚ ğŸ’¡ Show-ErrorHelp($StatusCode)                                   â”‚
â”‚    â””â”€ Sugerencias segÃºn cÃ³digo HTTP                             â”‚
â”‚    â””â”€ Soluciones especÃ­ficas por error                          â”‚
â”‚                                                                  â”‚
â”‚ ğŸ”„ Ask-Retry()                                                   â”‚
â”‚    â””â”€ Pregunta si desea reintentar                              â”‚
â”‚    â””â”€ Retorna $true/$false                                      â”‚
â”‚                                                                  â”‚
â”‚ ğŸ“ Ask-ChangeFile()                                              â”‚
â”‚    â””â”€ Pregunta si desea cambiar archivo                         â”‚
â”‚    â””â”€ Retorna $true/$false                                      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¨ Esquema de Colores

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           SIGNIFICADO DE COLORES               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸŸ¦ Cyan    â†’ TÃ­tulos, secciones, informaciÃ³n  â”‚
â”‚ ğŸŸ© Green   â†’ Ã‰xito, confirmaciones             â”‚
â”‚ ğŸŸ¨ Yellow  â†’ Advertencias, preguntas           â”‚
â”‚ ğŸŸ¥ Red     â†’ Errores crÃ­ticos                  â”‚
â”‚ â¬œ Gray    â†’ InformaciÃ³n secundaria            â”‚
â”‚ â¬œ White   â†’ Texto principal                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ Estructura de Respuesta API

```
ImportaciÃ³n Exitosa:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ {                                          â”‚
â”‚   "totalProcessed": 3,                     â”‚
â”‚   "successCount": 3,                       â”‚
â”‚   "failureCount": 0,                       â”‚
â”‚   "errors": [],                            â”‚
â”‚   "createdProducts": [                     â”‚
â”‚     {                                      â”‚
â”‚       "idProducto": 101,                   â”‚
â”‚       "nombreBase": "Producto 1",          â”‚
â”‚       "variaciones": [...]                 â”‚
â”‚     }                                      â”‚
â”‚   ],                                       â”‚
â”‚   "message": "ImportaciÃ³n completada..."   â”‚
â”‚ }                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MOSTRAR EN SCRIPT:                        â”‚
â”‚  âœ… 3 procesados                           â”‚
â”‚  âœ… 3 exitosos                             â”‚
â”‚  âœ… 0 fallidos                             â”‚
â”‚  âœ¨ Lista de productos creados            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ImportaciÃ³n con Errores:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ {                                          â”‚
â”‚   "totalProcessed": 5,                     â”‚
â”‚   "successCount": 3,                       â”‚
â”‚   "failureCount": 2,                       â”‚
â”‚   "errors": [                              â”‚
â”‚     "LÃ­nea 3: Producto ya existe",         â”‚
â”‚     "LÃ­nea 5: CategorÃ­a no encontrada"     â”‚
â”‚   ],                                       â”‚
â”‚   "createdProducts": [...],                â”‚
â”‚   "message": "3 creados, 2 errores"        â”‚
â”‚ }                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MOSTRAR EN SCRIPT:                        â”‚
â”‚  âš ï¸ 5 procesados                          â”‚
â”‚  âœ… 3 exitosos                             â”‚
â”‚  âŒ 2 fallidos                             â”‚
â”‚  âš ï¸ ERRORES ENCONTRADOS:                  â”‚
â”‚     â€¢ LÃ­nea 3: Producto ya existe         â”‚
â”‚     â€¢ LÃ­nea 5: CategorÃ­a no encontrada    â”‚
â”‚  âœ¨ 3 productos creados                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Ciclo de Vida del Script

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CICLO DE REINTENTOS                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   INICIO    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ while             â”‚      â”‚ Variables de control:â”‚
â”‚ ($continueImport) â”‚â—„â”€â”€â”€â”€â”€â”¤ $continueImport      â”‚
â”‚                   â”‚      â”‚ $csvFilePath         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Solicitar  â”‚
    â”‚ archivo    â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Validar    â”‚
    â”‚ archivo    â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚
      â”Œâ”€â”€â”€â”´â”€â”€â”€â”
      â”‚ Â¿OK?  â”‚
      â””â”¬â”€â”€â”€â”€â”€â”¬â”˜
   NO  â”‚     â”‚ SÃ
       â”‚     â”‚
       â–¼     â–¼
    â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Ask â”‚ â”‚ Importar â”‚
    â”‚Retryâ”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
    â””â”€â”¬â”€â”€â”˜      â”‚
      â”‚         â–¼
      â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚    â”‚ Mostrar â”‚
      â”‚    â”‚resultadoâ”‚
      â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚         â”‚
      â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
      â”‚    â”‚ Â¿Exitoso? â”‚
      â”‚    â””â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”˜
      â”‚ NO  â”‚         â”‚ SÃ
      â”‚     â”‚         â”‚
      â”‚     â–¼         â–¼
      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  â”‚ Ask    â”‚ â”‚ Ask     â”‚
      â”‚  â”‚ Change â”‚ â”‚ Another â”‚
      â”‚  â”‚ File   â”‚ â”‚ File    â”‚
      â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚      â”‚           â”‚
      â”‚  â”Œâ”€â”€â”€â”´â”€â”€â”€â”   â”Œâ”€â”€â”€â”´â”€â”€â”€â”
      â”‚  â”‚ SÃ­/No â”‚   â”‚ SÃ­/No â”‚
      â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”˜
      â”‚      â”‚           â”‚
      â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â–º Evaluar
                                  $continueImport
                                       â”‚
                                  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
                                  â”‚Continue?â”‚
                                  â””â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”˜
                              SÃ  â”‚       â”‚ NO
                                  â”‚       â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                               â”‚
                     â””â”€â”€â–º Loop al inicio             â–¼
                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                              â”‚   FIN    â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ Checklist de Validaciones

```
âœ… ValidaciÃ³n de Archivo:
   â”œâ”€ âœ“ Existe el archivo
   â”œâ”€ âœ“ ExtensiÃ³n .csv (con opciÃ³n de continuar)
   â”œâ”€ âœ“ TamaÃ±o del archivo
   â””â”€ âœ“ Fecha de Ãºltima modificaciÃ³n

âœ… ValidaciÃ³n de Solicitud:
   â”œâ”€ âœ“ Backend disponible
   â”œâ”€ âœ“ URL correcta
   â”œâ”€ âœ“ Formato multipart/form-data
   â””â”€ âœ“ CodificaciÃ³n UTF-8

âœ… ValidaciÃ³n de Respuesta:
   â”œâ”€ âœ“ CÃ³digo HTTP vÃ¡lido
   â”œâ”€ âœ“ JSON vÃ¡lido
   â”œâ”€ âœ“ Estructura esperada
   â””â”€ âœ“ Campos requeridos presentes

âœ… Manejo de Errores:
   â”œâ”€ âœ“ Errores de red
   â”œâ”€ âœ“ Errores HTTP (400, 404, 500)
   â”œâ”€ âœ“ Errores de parseo JSON
   â””â”€ âœ“ Errores de negocio (duplicados, etc.)
```

---

**VersiÃ³n del diagrama:** 1.0  
**Fecha:** Enero 2025  
**Script:** importar-masivo.ps1
