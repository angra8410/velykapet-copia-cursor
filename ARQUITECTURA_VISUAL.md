# ğŸ—ï¸ Arquitectura Visual - Sistema VentasPet

Este documento proporciona diagramas visuales de la arquitectura del sistema completo.

---

## ğŸ“Š Vista General del Sistema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SISTEMA VENTASPET                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     â”‚         â”‚                     â”‚         â”‚              â”‚
â”‚   FRONTEND          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   BACKEND .NET      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  BASE DE     â”‚
â”‚   React 18          â”‚  HTTP/  â”‚   ASP.NET Core      â”‚  EF     â”‚  DATOS       â”‚
â”‚   Port: 3333        â”‚  REST   â”‚   Port: 5135        â”‚  Core   â”‚  SQL Server  â”‚
â”‚                     â”‚         â”‚                     â”‚         â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                               â”‚
         â”‚                               â”‚
         â–¼                               â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ localStorage â”‚              â”‚   Swagger    â”‚
  â”‚   - Token    â”‚              â”‚   /swagger   â”‚
  â”‚   - Usuario  â”‚              â”‚              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Flujo de AutenticaciÃ³n JWT

```
USUARIO                 FRONTEND                BACKEND                 BASE DE DATOS
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚  1. Ingresa email/pwd  â”‚                       â”‚                          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚                          â”‚
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚                        â”‚  2. POST /Auth/login  â”‚                          â”‚
  â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                          â”‚
  â”‚                        â”‚  {email, password}    â”‚                          â”‚
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚                        â”‚                       â”‚  3. SELECT * FROM        â”‚
  â”‚                        â”‚                       â”‚     Usuarios WHERE       â”‚
  â”‚                        â”‚                       â”‚     Email = @email       â”‚
  â”‚                        â”‚                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚                        â”‚                       â”‚  4. Usuario encontrado   â”‚
  â”‚                        â”‚                       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚                        â”‚                       â”‚  5. VerifyPassword()     â”‚
  â”‚                        â”‚                       â”‚     PasswordHash +       â”‚
  â”‚                        â”‚                       â”‚     PasswordSalt         â”‚
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚                        â”‚                       â”‚  6. GenerarToken()       â”‚
  â”‚                        â”‚                       â”‚     Claims: Id, Email    â”‚
  â”‚                        â”‚                       â”‚     Expiry: 24h          â”‚
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚                        â”‚  7. Response:         â”‚                          â”‚
  â”‚                        â”‚  { token, user }      â”‚                          â”‚
  â”‚                        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                          â”‚
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚                        â”‚  8. Save to           â”‚                          â”‚
  â”‚                        â”‚     localStorage      â”‚                          â”‚
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚  9. Usuario logueado   â”‚                       â”‚                          â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚                          â”‚
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚                        â”‚  10. GET /Products    â”‚                          â”‚
  â”‚                        â”‚  Header: Bearer JWT   â”‚                          â”‚
  â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                          â”‚
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚                        â”‚                       â”‚  11. Validate JWT        â”‚
  â”‚                        â”‚                       â”‚      Extract Claims      â”‚
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚                        â”‚                       â”‚  12. SELECT FROM         â”‚
  â”‚                        â”‚                       â”‚      Productos           â”‚
  â”‚                        â”‚                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚                        â”‚                       â”‚  13. Productos           â”‚
  â”‚                        â”‚                       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚                        â”‚  14. Productos JSON   â”‚                          â”‚
  â”‚                        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                          â”‚
  â”‚                        â”‚                       â”‚                          â”‚
  â”‚  15. Muestra productos â”‚                       â”‚                          â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚                          â”‚
  â”‚                        â”‚                       â”‚                          â”‚
```

---

## ğŸ›ï¸ Arquitectura en Capas del Backend

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PRESENTATION LAYER                         â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚     Auth     â”‚  â”‚  Productos   â”‚  â”‚   Ordenes    â”‚           â”‚
â”‚  â”‚  Controller  â”‚  â”‚  Controller  â”‚  â”‚  Controller  â”‚  + More    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚         â”‚                 â”‚                 â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚                 â”‚
          â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        BUSINESS LOGIC LAYER                        â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚     Auth     â”‚  â”‚  Productos   â”‚  â”‚   Ordenes    â”‚           â”‚
â”‚  â”‚   Service    â”‚  â”‚   Service    â”‚  â”‚   Service    â”‚  + More    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚         â”‚                 â”‚                 â”‚                     â”‚
â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                     â”‚
â”‚         â””â”€â–ºâ”‚    JWT Helper            â”‚     â”‚                     â”‚
â”‚            â”‚    Password Helper       â”‚â—„â”€â”€â”€â”€â”˜                     â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                     â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DATA ACCESS LAYER                           â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   Usuario    â”‚  â”‚  Producto    â”‚  â”‚    Orden     â”‚           â”‚
â”‚  â”‚  Repository  â”‚  â”‚  Repository  â”‚  â”‚  Repository  â”‚  + More    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚         â”‚                 â”‚                 â”‚                     â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                           â”‚                                       â”‚
â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                 â”‚   DbContext       â”‚                            â”‚
â”‚                 â”‚  (EF Core)        â”‚                            â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATABASE LAYER                             â”‚
â”‚                                                                    â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚     â”‚ Usuarios â”‚  â”‚Productos â”‚  â”‚ Ordenes  â”‚  â”‚Categoriasâ”‚      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                    â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚     â”‚  Marcas  â”‚  â”‚DetallesOrden â”‚                               â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                    â”‚
â”‚                      SQL Server Database                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ Modelo de Datos Relacional

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     USUARIOS        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Id (PK)           â”‚
â”‚ â€¢ Email (UQ)        â”‚
â”‚ â€¢ Nombre            â”‚
â”‚ â€¢ PasswordHash      â”‚
â”‚ â€¢ PasswordSalt      â”‚
â”‚ â€¢ Rol               â”‚
â”‚ â€¢ Activo            â”‚
â”‚ â€¢ FechaCreacion     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ 1
           â”‚
           â”‚ N
           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ORDENES        â”‚                    â”‚    CATEGORIAS       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Id (PK)           â”‚                    â”‚ â€¢ Id (PK)           â”‚
â”‚ â€¢ UsuarioId (FK)    â”‚                    â”‚ â€¢ Nombre (UQ)       â”‚
â”‚ â€¢ NumeroOrden (UQ)  â”‚                    â”‚ â€¢ Descripcion       â”‚
â”‚ â€¢ EstadoOrden       â”‚                    â”‚ â€¢ Activo            â”‚
â”‚ â€¢ Total             â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ â€¢ Subtotal          â”‚                               â”‚
â”‚ â€¢ DireccionEnvio    â”‚                               â”‚ 1
â”‚ â€¢ Ciudad            â”‚                               â”‚
â”‚ â€¢ FechaCreacion     â”‚                               â”‚ N
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
           â”‚                                          â”‚
           â”‚ 1                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                      â”‚       PRODUCTOS              â”‚
           â”‚ N                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
           â”‚                      â”‚ â€¢ Id (PK)                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚ â€¢ Nombre                     â”‚
â”‚  DETALLES ORDEN     â”‚           â”‚ â€¢ Descripcion                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚ â€¢ Precio                     â”‚
â”‚ â€¢ Id (PK)           â”‚           â”‚ â€¢ Stock                      â”‚
â”‚ â€¢ OrdenId (FK) â”€â”€â”€â”€â”€â”˜           â”‚ â€¢ CategoriaId (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ â€¢ ProductoId (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â€¢ MarcaId (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ Cantidad          â”‚           â”‚ â€¢ UrlImagen              â”‚
â”‚ â€¢ PrecioUnitario    â”‚           â”‚ â€¢ TipoMascota            â”‚
â”‚ â€¢ Subtotal          â”‚           â”‚ â€¢ Activo                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â€¢ FechaCreacion          â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â”‚ N
                                             â”‚
                                             â”‚ 1
                                             â”‚
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚      MARCAS         â”‚
                                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                  â”‚ â€¢ Id (PK)           â”‚
                                  â”‚ â€¢ Nombre (UQ)       â”‚
                                  â”‚ â€¢ Descripcion       â”‚
                                  â”‚ â€¢ Activo            â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Leyenda:**
- `PK` = Primary Key (Llave Primaria)
- `FK` = Foreign Key (Llave ForÃ¡nea)
- `UQ` = Unique (Ãšnico)
- `1` = RelaciÃ³n Uno
- `N` = RelaciÃ³n Muchos

---

## ğŸ“‚ Estructura de Directorios del Backend

```
VentasPetApi/
â”‚
â”œâ”€â”€ ğŸ“ Controllers/                    # API Endpoints
â”‚   â”œâ”€â”€ ğŸ¯ AuthController.cs          # AutenticaciÃ³n y registro
â”‚   â”œâ”€â”€ ğŸ¯ ProductosController.cs     # CRUD de productos
â”‚   â”œâ”€â”€ ğŸ¯ OrdenesController.cs       # GestiÃ³n de Ã³rdenes
â”‚   â”œâ”€â”€ ğŸ¯ CategoriasController.cs    # CategorÃ­as
â”‚   â””â”€â”€ ğŸ¯ MarcasController.cs        # Marcas
â”‚
â”œâ”€â”€ ğŸ“ Models/
â”‚   â”œâ”€â”€ ğŸ“ Entities/                   # Entidades de base de datos
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Usuario.cs
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Producto.cs
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Orden.cs
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ DetalleOrden.cs
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Categoria.cs
â”‚   â”‚   â””â”€â”€ ğŸ“„ Marca.cs
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ DTOs/                       # Data Transfer Objects
â”‚       â”œâ”€â”€ ğŸ“ Auth/
â”‚       â”‚   â”œâ”€â”€ LoginDto.cs
â”‚       â”‚   â”œâ”€â”€ RegisterDto.cs
â”‚       â”‚   â””â”€â”€ UsuarioDto.cs
â”‚       â”œâ”€â”€ ğŸ“ Productos/
â”‚       â”‚   â”œâ”€â”€ ProductoDto.cs
â”‚       â”‚   â””â”€â”€ CrearProductoDto.cs
â”‚       â””â”€â”€ ğŸ“ Ordenes/
â”‚           â”œâ”€â”€ OrdenDto.cs
â”‚           â””â”€â”€ CrearOrdenDto.cs
â”‚
â”œâ”€â”€ ğŸ“ Data/                           # Acceso a datos
â”‚   â”œâ”€â”€ ğŸ“„ VentasPetDbContext.cs      # DbContext principal
â”‚   â””â”€â”€ ğŸ“ Configurations/
â”‚       â”œâ”€â”€ UsuarioConfiguration.cs
â”‚       â”œâ”€â”€ ProductoConfiguration.cs
â”‚       â””â”€â”€ OrdenConfiguration.cs
â”‚
â”œâ”€â”€ ğŸ“ Services/                       # LÃ³gica de negocio
â”‚   â”œâ”€â”€ ğŸ“ Interfaces/
â”‚   â”‚   â”œâ”€â”€ IAuthService.cs
â”‚   â”‚   â”œâ”€â”€ IProductoService.cs
â”‚   â”‚   â””â”€â”€ IOrdenService.cs
â”‚   â””â”€â”€ ğŸ“ Implementations/
â”‚       â”œâ”€â”€ ğŸ”§ AuthService.cs
â”‚       â”œâ”€â”€ ğŸ”§ ProductoService.cs
â”‚       â””â”€â”€ ğŸ”§ OrdenService.cs
â”‚
â”œâ”€â”€ ğŸ“ Repositories/                   # Acceso a datos
â”‚   â”œâ”€â”€ ğŸ“ Interfaces/
â”‚   â”‚   â”œâ”€â”€ IGenericRepository.cs
â”‚   â”‚   â”œâ”€â”€ IUsuarioRepository.cs
â”‚   â”‚   â””â”€â”€ IProductoRepository.cs
â”‚   â””â”€â”€ ğŸ“ Implementations/
â”‚       â”œâ”€â”€ ğŸ’¾ GenericRepository.cs
â”‚       â”œâ”€â”€ ğŸ’¾ UsuarioRepository.cs
â”‚       â””â”€â”€ ğŸ’¾ ProductoRepository.cs
â”‚
â”œâ”€â”€ ğŸ“ Middleware/                     # Middleware personalizado
â”‚   â”œâ”€â”€ ErrorHandlingMiddleware.cs
â”‚   â””â”€â”€ JwtMiddleware.cs
â”‚
â”œâ”€â”€ ğŸ“ Helpers/                        # Utilidades
â”‚   â”œâ”€â”€ ğŸ” JwtHelper.cs               # GeneraciÃ³n y validaciÃ³n de JWT
â”‚   â”œâ”€â”€ ğŸ” PasswordHelper.cs          # Hash y verificaciÃ³n de passwords
â”‚   â””â”€â”€ ğŸ—ºï¸ MappingProfiles.cs        # AutoMapper profiles
â”‚
â”œâ”€â”€ ğŸ“ Migrations/                     # Migraciones EF Core
â”‚   â””â”€â”€ (generadas automÃ¡ticamente)
â”‚
â”œâ”€â”€ âš™ï¸ Program.cs                      # ConfiguraciÃ³n principal
â”œâ”€â”€ âš™ï¸ appsettings.json               # ConfiguraciÃ³n de aplicaciÃ³n
â”œâ”€â”€ âš™ï¸ appsettings.Development.json   # Config de desarrollo
â””â”€â”€ ğŸ“¦ VentasPetApi.csproj            # Archivo de proyecto
```

---

## ğŸ”„ Flujo de una PeticiÃ³n HTTP Completo

```
1. CLIENTE ENVÃA REQUEST
   â”‚
   â”‚  GET /api/Products
   â”‚  Authorization: Bearer eyJhbGc...
   â”‚
   â–¼
2. MIDDLEWARE PIPELINE
   â”‚
   â”œâ”€â–º Error Handling Middleware
   â”œâ”€â–º CORS Middleware
   â”œâ”€â–º Authentication Middleware
   â”‚    â”‚
   â”‚    â”œâ”€â–º Validar JWT Token
   â”‚    â”œâ”€â–º Extraer Claims (Id, Email, Rol)
   â”‚    â””â”€â–º Crear ClaimsPrincipal
   â”‚
   â””â”€â–º Authorization Middleware
        â”‚
        â””â”€â–º Verificar permisos/roles
   â”‚
   â–¼
3. ROUTING
   â”‚
   â””â”€â–º ProductosController.GetProductos()
   â”‚
   â–¼
4. CONTROLLER
   â”‚
   â”‚  [Authorize]
   â”‚  public async Task<IActionResult> GetProductos(
   â”‚      [FromQuery] string? search,
   â”‚      [FromQuery] int? categoriaId
   â”‚  )
   â”‚  {
   â”‚      var productos = await _productoService
   â”‚          .GetProductosAsync(search, categoriaId);
   â”‚      return Ok(productos);
   â”‚  }
   â”‚
   â–¼
5. SERVICE LAYER
   â”‚
   â”‚  public async Task<List<ProductoDto>> 
   â”‚      GetProductosAsync(string? search, int? categoriaId)
   â”‚  {
   â”‚      var productos = await _repository
   â”‚          .GetFilteredAsync(search, categoriaId);
   â”‚      
   â”‚      return _mapper.Map<List<ProductoDto>>(productos);
   â”‚  }
   â”‚
   â–¼
6. REPOSITORY LAYER
   â”‚
   â”‚  public async Task<List<Producto>> 
   â”‚      GetFilteredAsync(string? search, int? categoriaId)
   â”‚  {
   â”‚      var query = _context.Productos
   â”‚          .Include(p => p.Categoria)
   â”‚          .Include(p => p.Marca)
   â”‚          .Where(p => !p.Eliminado);
   â”‚      
   â”‚      if (!string.IsNullOrEmpty(search))
   â”‚          query = query.Where(p => p.Nombre.Contains(search));
   â”‚      
   â”‚      if (categoriaId.HasValue)
   â”‚          query = query.Where(p => p.CategoriaId == categoriaId);
   â”‚      
   â”‚      return await query.ToListAsync();
   â”‚  }
   â”‚
   â–¼
7. DATABASE
   â”‚
   â”‚  SELECT p.*, c.*, m.*
   â”‚  FROM Productos p
   â”‚  LEFT JOIN Categorias c ON p.CategoriaId = c.Id
   â”‚  LEFT JOIN Marcas m ON p.MarcaId = m.Id
   â”‚  WHERE p.Eliminado = 0
   â”‚    AND (p.Nombre LIKE '%search%' OR @search IS NULL)
   â”‚    AND (p.CategoriaId = @categoriaId OR @categoriaId IS NULL)
   â”‚
   â–¼
8. RESULTADO REGRESA
   â”‚
   â”‚  List<Producto> â†’ Service
   â”‚                 â†“
   â”‚  AutoMapper convierte a List<ProductoDto>
   â”‚                 â†“
   â”‚  Service â†’ Controller
   â”‚                 â†“
   â”‚  Controller serializa a JSON
   â”‚                 â†“
   â”‚  Response HTTP 200 OK
   â”‚
   â–¼
9. CLIENTE RECIBE
   â”‚
   â”‚  {
   â”‚    "id": 1,
   â”‚    "nombre": "Royal Canin Adult",
   â”‚    "precio": 89000,
   â”‚    "stock": 25,
   â”‚    "categoria": "Alimento",
   â”‚    "marca": "Royal Canin"
   â”‚  }
```

---

## ğŸŒ Endpoints RESTful del API

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                      ENDPOINTS DE AUTENTICACIÃ“N                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MÃ©todo  â”‚      Endpoint       â”‚     Auth     â”‚   DescripciÃ³n   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  POST    â”‚ /api/Auth/register  â”‚ AnÃ³nimo      â”‚ Registrar user  â”‚
â”‚  POST    â”‚ /api/Auth/login     â”‚ AnÃ³nimo      â”‚ Iniciar sesiÃ³n  â”‚
â”‚  GET     â”‚ /api/Auth/me        â”‚ JWT Required â”‚ Usuario actual  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                      ENDPOINTS DE PRODUCTOS                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MÃ©todo  â”‚      Endpoint       â”‚     Auth     â”‚   DescripciÃ³n   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GET     â”‚ /api/Products       â”‚ PÃºblico      â”‚ Listar todos    â”‚
â”‚  GET     â”‚ /api/Products/{id}  â”‚ PÃºblico      â”‚ Obtener por ID  â”‚
â”‚  POST    â”‚ /api/Products       â”‚ Admin        â”‚ Crear producto  â”‚
â”‚  PUT     â”‚ /api/Products/{id}  â”‚ Admin        â”‚ Actualizar      â”‚
â”‚  DELETE  â”‚ /api/Products/{id}  â”‚ Admin        â”‚ Eliminar        â”‚
â”‚  POST    â”‚ /api/Products/bulk  â”‚ Admin        â”‚ Importar varios â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                       ENDPOINTS DE Ã“RDENES                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MÃ©todo  â”‚      Endpoint       â”‚     Auth     â”‚   DescripciÃ³n   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GET     â”‚ /api/Orders         â”‚ JWT Required â”‚ Mis Ã³rdenes     â”‚
â”‚  GET     â”‚ /api/Orders/{id}    â”‚ JWT Required â”‚ Detalle orden   â”‚
â”‚  POST    â”‚ /api/Orders         â”‚ JWT Required â”‚ Crear orden     â”‚
â”‚  PUT     â”‚ /api/Orders/{id}    â”‚ JWT Required â”‚ Actualizar      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ENDPOINTS DE CATEGORÃAS                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MÃ©todo  â”‚      Endpoint       â”‚     Auth     â”‚   DescripciÃ³n   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GET     â”‚ /api/Categorias     â”‚ PÃºblico      â”‚ Listar todas    â”‚
â”‚  GET     â”‚ /api/Categorias/{id}â”‚ PÃºblico      â”‚ Obtener por ID  â”‚
â”‚  POST    â”‚ /api/Categorias     â”‚ Admin        â”‚ Crear categorÃ­a â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Seguridad - Flujo de Tokens JWT

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ESTRUCTURA DEL JWT TOKEN                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Header (Base64 encoded)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ {                          â”‚
â”‚   "alg": "HS256",          â”‚  â—„â”€â”€â”€ Algoritmo de firma
â”‚   "typ": "JWT"             â”‚  â—„â”€â”€â”€ Tipo de token
â”‚ }                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Payload (Base64 encoded)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ {                          â”‚
â”‚   "Id": "1",               â”‚  â—„â”€â”€â”€ Claims del usuario
â”‚   "email": "user@ex.com",  â”‚
â”‚   "name": "Usuario",       â”‚
â”‚   "role": "Cliente",       â”‚
â”‚   "exp": 1234567890,       â”‚  â—„â”€â”€â”€ Fecha de expiraciÃ³n
â”‚   "iss": "VentasPetAPI",   â”‚  â—„â”€â”€â”€ Emisor
â”‚   "aud": "VentasPetClients"â”‚  â—„â”€â”€â”€ Audiencia
â”‚ }                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Signature (HMACSHA256)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HMACSHA256(                â”‚
â”‚   base64(header) + "." +   â”‚
â”‚   base64(payload),         â”‚
â”‚   secret_key               â”‚  â—„â”€â”€â”€ Llave secreta
â”‚ )                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RESULTADO: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJJZCI6IjEi...
```

**ValidaciÃ³n del Token:**
1. âœ… Firma vÃ¡lida (con secret key)
2. âœ… No ha expirado (exp claim)
3. âœ… Emisor correcto (iss claim)
4. âœ… Audiencia correcta (aud claim)

---

## ğŸ“ˆ Plan de ImplementaciÃ³n en Fases

```
FASE 1: PREPARACIÃ“N                    [Semana 1]
â”œâ”€â”€ Crear proyecto .NET
â”œâ”€â”€ Configurar Entity Framework
â”œâ”€â”€ Crear scripts de base de datos
â”œâ”€â”€ Configurar JWT y CORS
â””â”€â”€ Documentar con Swagger
    â”‚
    â–¼
FASE 2: DESARROLLO CORE                [Semanas 2-3]
â”œâ”€â”€ Implementar modelos de entidades
â”œâ”€â”€ Crear repositorios genÃ©ricos
â”œâ”€â”€ AuthController y AuthService
â”œâ”€â”€ ProductosController
â”œâ”€â”€ OrdenesController
â””â”€â”€ Testing unitario bÃ¡sico
    â”‚
    â–¼
FASE 3: INTEGRACIÃ“N FRONTEND          [Semana 4]
â”œâ”€â”€ Verificar compatibilidad endpoints
â”œâ”€â”€ Ajustar respuestas JSON
â”œâ”€â”€ Testing de integraciÃ³n
â”œâ”€â”€ Verificar flujo autenticaciÃ³n
â””â”€â”€ Verificar flujo de compra
    â”‚
    â–¼
FASE 4: MIGRACIÃ“N DE DATOS            [Semana 5]
â”œâ”€â”€ Exportar datos sistema anterior
â”œâ”€â”€ Crear scripts de migraciÃ³n
â”œâ”€â”€ Validar integridad de datos
â””â”€â”€ Backup completo
    â”‚
    â–¼
FASE 5: TESTING Y QA                  [Semana 6]
â”œâ”€â”€ Testing de carga
â”œâ”€â”€ Testing de seguridad
â”œâ”€â”€ Testing end-to-end
â””â”€â”€ CorrecciÃ³n de bugs
    â”‚
    â–¼
FASE 6: DESPLIEGUE                    [Semana 7]
â”œâ”€â”€ Configurar ambiente producciÃ³n
â”œâ”€â”€ Configurar SSL/HTTPS
â”œâ”€â”€ Configurar logging y monitoring
â”œâ”€â”€ Despliegue gradual
â””â”€â”€ Monitoreo post-despliegue
```

---

## ğŸ“š Referencias RÃ¡pidas

### Documentos del Proyecto
- ğŸ“– [AnÃ¡lisis Completo](./ANALISIS_BACKEND_DOTNET.md) - 1668 lÃ­neas de anÃ¡lisis detallado
- ğŸš€ [GuÃ­a RÃ¡pida](./GUIA_RAPIDA_IMPLEMENTACION.md) - Tutorial paso a paso
- ğŸ“œ [Scripts de Inicio](./SCRIPTS_README.md) - Iniciar servidores
- âš™ï¸ [ConfiguraciÃ³n de Ambientes](./AMBIENTES.md) - Variables de entorno

### Puertos del Sistema
- Frontend: `http://localhost:3333`
- Backend: `http://localhost:5135`
- Swagger: `http://localhost:5135/swagger`

### Credenciales de Prueba
- Email: `admin@ventaspet.com`
- Password: `Admin123!`

---

**ğŸ¾ VentasPet - Arquitectura Visual**

*Ãšltima actualizaciÃ³n: 2024*
